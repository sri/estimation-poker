<head>
  <title>estimation-poker</title>
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
</head>

<body>
  <div class="container">
   {{> user}}
   {{> estimates}}
  </div>
  <footer class="footer">
    <div class="container">
      <p class="text-muted">by <a href="https://twitter.com/s_thai">@s_thai</a></p>
    </div>
  </footer>
</body>

<template name="user">
  <div class="user">
    {{#if user}}
    {{else}}
      <div class="page-header">
        <h1>Estimation.poker()</h1>
      </div>
      <form>
        <div class="input-group">
          <input type="text" class="form-control" name="username" id="username" placeholder="Your Name"/>
          <span class="input-group-btn">
            <input type="submit" class="btn btn-primary" value="Join Session">
          </span>
        </div>
      </form>
    {{/if}}
  </div>
</template>

<template name="users">
  <li class="list-group-item">
    <span class="badge votes-header">
      <b>Votes</b>
    </span>
    <span class="glyphicon glyphicon-user"></span>
    <b>Users</b>
  </li>
  {{#each connectedUsers}}
    <li class="list-group-item">
      <span class="badge">
        {{#if hasVote username}}
          <span class="glyphicon glyphicon-question-sign glyph-big"></span>
        {{else}}
          <span class="glyphicon glyphicon-minus glyph-big"></span>
        {{/if}}
      </span>
      {{username}}
    </li>
  {{/each}}
</template>

<template name="estimates">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">
        Estimates
        {{#if user}}
          <span class="label label-primary clear-user" title="Click to clear this username">
            <span class="glyphicon glyphicon-user"></span>
            {{user}}
          </span>
        {{/if}}
      </h3>
    </div>
    <div class="panel-body">
      {{#with openEstimate}}
        <div class="estimate open-estimate">
          <div class="panel panel-success">
            <div class="panel-heading">
              <h4 class="panel-title">
                <div class="estimate-name hidden-xs">
                  <span class="glyphicon glyphicon-pencil"></span>
                </div>
                <div class="visible-xs-block">
                  {{#if hasName name}}
                    {{name}}
                  {{/if}}&nbsp;
                </div>
                <div class="estimate-name hidden-xs">
                  {{#if hasName name}}
                    {{name}}
                  {{/if}}
                  &nbsp;
                </div>
                <div class="hidden-xs">
                  <div class="estimate-edit">
                    <form>
                      <input type="text" class="form-control" id="estimatename" name="estimatename" placeholder="New name..." />
                    </form>
                  </div>
                </div>
              </h4>
            </div>
            <div class="panel-body points">
              <div class="visible-xs-block">
                <button type="button" class="btn btn-default btn-lg btn-block point2">2</button>
                <button type="button" class="btn btn-default btn-lg btn-block point2">3</button>
                <button type="button" class="btn btn-default btn-lg btn-block point2">5</button>
                <button type="button" class="btn btn-default btn-lg btn-block point2">8</button>
                <button type="button" class="btn btn-default btn-lg btn-block point2">13</button>
                <button type="button" class="btn btn-default btn-lg btn-block point2">
                  &infin;
                </button>
                <button type="button" class="btn btn-default btn-lg btn-block point2">
                  Back to Product
                </button>
              </div>
              <div class="btn-group hidden-xs" role="group">
                <button type="button" class="btn btn-default point">2</button>
                <button type="button" class="btn btn-default point">3</button>
                <button type="button" class="btn btn-default point">5</button>
                <button type="button" class="btn btn-default point">8</button>
                <button type="button" class="btn btn-default point">13</button>
                <div class="btn-group" role="group">
                   <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                     More
                     <span class="caret"></span>
                   </button>
                   <ul class="dropdown-menu">
                     <li><a href="" class="dd-point">&infin;</a></li>
                     <li><a href="" class="dd-point">Back to Product</a></li>
                   </ul>
                 </div>
              </div>
            </div>
            <ul class="list-group">
              {{> users id=_id}}
              <li class="list-group-item">
                <button type="button" class="btn btn-info btn-lg btn-block show-votes">
                  Show Votes <span class="glyphicon glyphicon-eye-open"></span>
                </button>
              </li>
            </ul>
          </div>
        </div>
      {{/with}}

      {{#each closedEstimates}}
        <div class="estimate closed-estimate">
          <div class="panel panel-default">
            <div class="panel-heading">
              <h4 class="panel-title">{{name}}&nbsp;</h4>
            </div>
            <ul class="list-group">
              {{> votes id=_id closed="true"}}
             <!--  <li class="list-group-item">
                <span class="badge">{{consensus id}}</span>
                <b>Consensus</b>
              </li> -->
            </ul>
          </div>
        </div>
      {{/each}}
    </div>
  </div>
</template>

<template name="votes">
  {{#each votes id}}
    <li class="list-group-item">
      <span class="badge">
        {{#if isClosed}}
          {{points}}
        {{else}}
          <span class="glyphicon glyphicon-question-sign question-sign"></span>
        {{/if}}
      </span>
      {{username}}
    </li>
  {{/each}}
</template>

