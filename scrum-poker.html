<head>
  <title>scrum-poker</title>
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
</head>

<body>
  <div class="container">
   {{> user}}
   {{> epics}}
  </div>
  <footer class="footer">
    <div class="container">
      <p class="text-muted">by <a href="https://twitter.com/s_thai">@s_thai</a></p>
    </div>
  </footer>
</body>

<template name="points">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">Points</h3>
    </div>
    <div class="panel-body points">
      <div class="btn-group" role="group">
        <button type="button" class="btn btn-default point">2</button>
        <button type="button" class="btn btn-default point">3</button>
        <button type="button" class="btn btn-default point">5</button>
        <button type="button" class="btn btn-default point">8</button>
        <button type="button" class="btn btn-default point">13</button>
        <div class="btn-group" role="group">
           <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
             More
             <span class="caret"></span>
           </button>
           <ul class="dropdown-menu">
             <li><a href="#">Back to Product</a></li>
             <li><a href="#">&infin;</a></li>
           </ul>
         </div>
      </div>
    </div>
  </div>
</template>

<template name="user">
  <div class="user">
    {{#if user}}
      <h2><span class="label label-info">{{user}}.i.am</span></h2>
    {{else}}
      <div class="page-header">
        <h1>Scrum.poker()</h1>
      </div>
      <form>
        <div class="input-group">
          <input type="text" class="form-control" name="username" placeholder="Name"/>
          <span class="input-group-btn">
            <input type="submit" class="btn btn-primary" value="Join Session">
          </span>
        </div>
      </form>
    {{/if}}
  </div>
</template>

<template name="epics">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">
        Epics
        <div class="create-epic">
          <span class="glyphicon glyphicon-plus" title="Create new Epic"></span>
        </div>
      </h3>
    </div>
    <div class="panel-body">
      {{#with openEpic}}
        <div class="epic open-epic">
          <div class="panel panel-success">
            <div class="panel-heading">
              <h4 class="panel-title">{{name}}</h4>
            </div>
            <div class="panel-body points">
              <div class="btn-group" role="group">
                <button type="button" class="btn btn-default point">2</button>
                <button type="button" class="btn btn-default point">3</button>
                <button type="button" class="btn btn-default point">5</button>
                <button type="button" class="btn btn-default point">8</button>
                <button type="button" class="btn btn-default point">13</button>
                <div class="btn-group" role="group">
                   <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                     More
                     <span class="caret"></span>
                   </button>
                   <ul class="dropdown-menu">
                     <li><a href="#">Back to Product</a></li>
                     <li><a href="#">&infin;</a></li>
                   </ul>
                 </div>
              </div>
            </div>
            <ul class="list-group">
              {{> votes id=_id closed="false"}}
              <li class="list-group-item">
                <button type="button" class="btn btn-default btn-lg btn-block show-votes">
                  Show Votes
                </button>
              </li>
            </ul>
          </div>
        </div>
      {{/with}}

      {{#each closedEpics}}
        <div class="epic closed-epic">
          <div class="panel panel-default">
            <div class="panel-heading">
              <h4 class="panel-title">{{name}}</h4>
            </div>
            <ul class="list-group">
              {{> votes id=_id closed="true"}}
            </ul>
          </div>
        </div>
      {{/each}}
    </div>
  </div>
</template>

<template name="votes">
  {{#each votes id}}
    <li class="list-group-item">
      <span class="badge">
        {{#if isClosed}}
          {{points}}
        {{else}}
          ?
        {{/if}}
      </span>
      {{by}}
    </li>
  {{/each}}
 <!-- <li class="list-group-item">
    <span class="badge">{{avg id}}</span>
    Avg
  </li> -->
</template>

